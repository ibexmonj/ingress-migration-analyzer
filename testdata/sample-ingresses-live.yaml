# Live sample Ingress resources for testing with kind cluster
# These correspond to the sample apps and demonstrate different risk levels

---
apiVersion: networking.k8s.io/v1
kind: Ingress
metadata:
  name: simple-echo
  namespace: default
  annotations:
    # AUTO-MIGRATABLE: Simple rewrite and SSL redirect
    nginx.ingress.kubernetes.io/rewrite-target: /
    nginx.ingress.kubernetes.io/ssl-redirect: "true"
    nginx.ingress.kubernetes.io/force-ssl-redirect: "true"
spec:
  ingressClassName: nginx
  rules:
  - host: echo.local
    http:
      paths:
      - path: /
        pathType: Prefix
        backend:
          service:
            name: echo-service
            port:
              number: 80

---
apiVersion: networking.k8s.io/v1
kind: Ingress
metadata:
  name: api-with-auth
  namespace: production
  annotations:
    # MANUAL REVIEW: Auth and body size limits
    nginx.ingress.kubernetes.io/auth-url: https://auth.example.com/oauth2/auth
    nginx.ingress.kubernetes.io/proxy-body-size: 50m
    nginx.ingress.kubernetes.io/proxy-read-timeout: "120"
    nginx.ingress.kubernetes.io/proxy-send-timeout: "120"
    # Also has auto-migratable
    nginx.ingress.kubernetes.io/ssl-redirect: "true"
    nginx.ingress.kubernetes.io/backend-protocol: "HTTP"
spec:
  ingressClassName: nginx
  rules:
  - host: api.example.com
    http:
      paths:
      - path: /api
        pathType: Prefix
        backend:
          service:
            name: api-service
            port:
              number: 80

---
apiVersion: networking.k8s.io/v1
kind: Ingress
metadata:
  name: high-risk-admin
  namespace: production
  annotations:
    # HIGH RISK: Server and configuration snippets
    nginx.ingress.kubernetes.io/server-snippet: |
      location ~ /admin/health {
        access_log off;
        return 200 "healthy\n";
        add_header Content-Type text/plain;
      }
      location ~ /admin/debug {
        deny all;
        return 403;
      }
    nginx.ingress.kubernetes.io/configuration-snippet: |
      more_set_headers "X-Admin-Server: $server_name";
      more_set_headers "X-Request-ID: $request_id";
      if ($request_method = DELETE) {
        return 405;
      }
    # Mixed with other types
    nginx.ingress.kubernetes.io/proxy-body-size: 10m
    nginx.ingress.kubernetes.io/client-body-buffer-size: 1m
spec:
  ingressClassName: nginx
  rules:
  - host: admin.example.com
    http:
      paths:
      - path: /admin
        pathType: Prefix
        backend:
          service:
            name: admin-service
            port:
              number: 8080

---
apiVersion: networking.k8s.io/v1
kind: Ingress
metadata:
  name: legacy-with-deprecated-annotation
  namespace: staging
  annotations:
    # Legacy annotation style (deprecated warning)
    kubernetes.io/ingress.class: nginx
    nginx.ingress.kubernetes.io/rewrite-target: /legacy
    nginx.ingress.kubernetes.io/use-regex: "true"
    nginx.ingress.kubernetes.io/enable-cors: "true"
    nginx.ingress.kubernetes.io/cors-allow-origin: "*"
spec:
  # Note: no ingressClassName specified (using legacy annotation)
  rules:
  - host: legacy.staging.com
    http:
      paths:
      - path: /old-app(/.*)?
        pathType: ImplementationSpecific
        backend:
          service:
            name: legacy-service
            port:
              number: 80

---
apiVersion: networking.k8s.io/v1
kind: Ingress
metadata:
  name: complex-routing
  namespace: production
  annotations:
    # Mix of AUTO and MANUAL
    nginx.ingress.kubernetes.io/rewrite-target: /api/$2
    nginx.ingress.kubernetes.io/use-regex: "true"
    nginx.ingress.kubernetes.io/proxy-connect-timeout: "5"
    nginx.ingress.kubernetes.io/proxy-read-timeout: "60"
    nginx.ingress.kubernetes.io/rate-limit-rps: "10"
    nginx.ingress.kubernetes.io/enable-cors: "true"
spec:
  ingressClassName: nginx
  rules:
  - host: api.complex.com
    http:
      paths:
      - path: /v1/(api/.*)?
        pathType: ImplementationSpecific
        backend:
          service:
            name: api-service
            port:
              number: 80

---
# Non-nginx ingress for comparison (should be ignored)
apiVersion: networking.k8s.io/v1
kind: Ingress
metadata:
  name: other-ingress-controller
  namespace: default
  annotations:
    nginx.org/redirects: "false"  # NGINX Inc annotation, not ingress-nginx
spec:
  ingressClassName: other
  rules:
  - host: other.example.com
    http:
      paths:
      - path: /
        pathType: Prefix
        backend:
          service:
            name: echo-service
            port:
              number: 80